# Google Apps Script Hello World セットアップガイド

このガイドでは、Google Apps Script (GAS) で最も基本的な "Hello World" スクリプトを作成・実行する手順を詳しく説明します。特に認証周りの注意点や、実際に遭遇した課題とその解決方法を含めて解説しています。

## 前提条件

- Googleアカウントを持っていること
- 2段階認証が設定されている場合は、認証デバイスにアクセスできること
- ブラウザ（Chrome推奨）がインストールされていること

## 詳細セットアップ手順

### 1. Google Apps Scriptへのアクセス

1. ブラウザで https://script.google.com/ にアクセス
   - 注意: 直接このURLにアクセスすることが最も確実です
   - Google Workspaceのメニューから辿る方法もありますが、手順が複雑になる可能性があります

2. Googleアカウントへのログイン
   - メールアドレスを入力
   - 「次へ」をクリック
   - パスワードを入力
   - 「次へ」をクリック

### 2. 2段階認証の処理 【重要】

この部分が最も注意が必要なポイントです：

1. デバイスでの認証
   - スマートフォンなどの認証デバイスに通知が送信されます
   - 「はい」をタップして承認する必要があります
   - **注意**: 通知が来ない場合は、以下を確認
     - デバイスがインターネットに接続されているか
     - Google認証アプリが最新版か
     - デバイスの通知設定が有効か

2. 認証の代替方法
   - 「別の方法を試す」オプションが利用可能
   - 登録済みの他のデバイスでも認証可能
   - バックアップコードを使用することも可能

3. よくある問題と解決方法
   - 認証後もページが進まない場合: ブラウザをリフレッシュ
   - デバイスが手元にない場合: 代替の認証方法を選択
   - 認証が繰り返し要求される場合: キャッシュをクリアして再試行

### 3. スクリプトエディタへのアクセス

1. 初回アクセス時
   - 自動的に新規プロジェクトが作成されます
   - デフォルトで「無題のプロジェクト」という名前が付きます
   - この時点でプロジェクトは自動保存されます

2. エディタの確認
   - デフォルトで`myFunction()`が用意されています
   - コードエディタが表示されない場合は、ページをリロード

### 4. Hello Worldスクリプトの作成

1. コードの入力
```javascript
function myFunction() {
  Logger.log("Hello World");
}
```

注意点：
- 関数名は既存の`myFunction`を使用（混乱を避けるため）
- インデントは2スペース（GASの標準）
- 波括弧`{}`の対応に注意
- セミコロン`;`を忘れずに付ける

2. コードの保存
   - 自動保存されますが、念のため`Ctrl+S`で手動保存も推奨
   - **重要**: 保存が完了するまで待つ（画面上部に表示される）

### 5. スクリプトの実行

1. 実行準備
   - 関数名（myFunction）を選択
   - ツールバーの「実行」ボタンを確認（グレーアウトしていないことを確認）

2. 初回実行時の権限設定
   - 「権限が必要です」というダイアログが表示される
   - 「権限を確認」をクリック
   - アカウントを選択
   - 「詳細」→「安全でないページに移動」をクリック
   - 「許可」をクリック

3. 実行結果の確認
   - 「実行ログ」パネルを開く
   - "Hello World"が表示されることを確認

## トラブルシューティング

### よく遭遇する問題

1. 認証関連
   - 症状: 2段階認証が完了しても進まない
   - 解決: ブラウザをリフレッシュして再試行
   - 予防策: プライベートブラウジングを避ける

2. エディタの問題
   - 症状: コードが保存されない
   - 解決: 手動保存（Ctrl+S）を実行
   - 予防策: 定期的に手動保存を行う

3. 実行の問題
   - 症状: 実行ボタンがグレーアウト
   - 解決: 関数名を正しく選択
   - 予防策: コードに構文エラーがないか確認

### 重要な注意点

1. ブラウザ設定
   - Cookieを有効にする
   - JavaScriptを有効にする
   - ポップアップブロックを無効にする（権限ダイアログのため）

2. セキュリティ設定
   - 組織のセキュリティポリシーによってはアクセスが制限される場合がある
   - VPNを使用している場合は一時的に無効にすることを検討

3. パフォーマンス
   - 大量のブラウザタブを開いている場合は閉じる
   - キャッシュが肥大化している場合はクリア

## ベストプラクティス

1. 作業前の準備
   - 認証デバイスを手元に用意
   - ブラウザを最新版に更新
   - 不要なブラウザ拡張機能を無効化

2. コーディング規約
   - インデントは2スペース
   - 関数名は分かりやすく
   - コメントは必要に応じて追加

3. デバッグ
   - Logger.logを活用
   - エラーメッセージを注意深く読む
   - 一度に大きな変更を加えない

## 次のステップ

基本的なHello Worldスクリプトの作成と実行ができたら、以下のような発展的な内容に挑戦できます：

1. スプレッドシートとの連携
2. カスタムメニューの作成
3. トリガーの設定
4. 外部APIとの連携

## 参考リンク

- [Google Apps Script公式ドキュメント](https://developers.google.com/apps-script)
- [Google Workspace開発者ポータル](https://developers.google.com/workspace)
- [Apps Script のクォータ制限](https://developers.google.com/apps-script/guides/services/quotas)

## トラブル時の連絡先

- Google Workspace管理者（組織で使用している場合）
- [Google Apps Script フォーラム](https://developers.google.com/apps-script/community)
