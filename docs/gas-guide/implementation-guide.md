# Google Apps Script カスタムメニュー実装手順

このガイドでは、スプレッドシートにカスタムメニューを追加する具体的な手順を説明します。

## 1. スプレッドシートの作成

1. Google Spreadsheetにアクセス
   - ブラウザで https://docs.google.com/spreadsheets を開く
   - Googleアカウントにログインしていない場合は、ログインを求められます

2. 新規スプレッドシートの作成
   - 左上の「＋」アイコンをクリック
   - または、左上の「空白のスプレッドシート」をクリック

## 2. スクリプトエディタを開く

1. メニューバーから「拡張機能」を選択
2. ドロップダウンメニューから「Apps Script」をクリック
   - 新しいタブでスクリプトエディタが開きます
   - デフォルトで`Code.gs`ファイルが作成されています

## 3. スクリプトの実装

1. デフォルトコードの削除
   - エディタに表示されている既存のコードを全て削除

2. カスタムメニューコードの追加
   ```javascript
   // ここにcustom-menu.gsの内容をコピー＆ペースト
   ```

3. プロジェクトの保存
   - 左上の「保存」アイコンをクリック（または Ctrl+S）
   - プロジェクト名を変更（任意）
     - 左上の「無題のプロジェクト」をクリック
     - 「カスタムメニュー」などの分かりやすい名前に変更

## 4. 初回設定と権限の承認

1. スプレッドシートに戻る
   - ブラウザのタブでスプレッドシートを表示
   - ページを更新（F5キー）

2. 権限の承認
   - 「🔧 ユーティリティ」メニューが表示される
   - メニューをクリックすると権限承認画面が表示
   - 「権限を確認」をクリック
   - Googleアカウントを選択
   - 「詳細」をクリック
   - 「安全でないページに移動」をクリック
   - 「許可」をクリック

## 5. メニューの使用方法

### データ操作機能
1. 合計表示
   - データを選択
   - 「📝 データ操作」→「選択したセルの合計を表示」
   - ポップアップで合計が表示

2. データの並べ替え
   - 列を選択
   - 「📝 データ操作」→「データを昇順/降順で並べ替え」
   - 選択したデータが自動的に並べ替え

### フォーマット機能
1. 罫線の追加
   - 範囲を選択
   - 「🎨 フォーマット」→「選択範囲に罫線を追加」

2. ヘッダー行の設定
   - 行を選択
   - 「🎨 フォーマット」→「ヘッダー行として設定」
   - 背景色と太字が適用

### 分析機能
1. 基本統計
   - 数値データを選択
   - 「📊 分析」→「基本統計を表示」
   - 合計、平均、最大値などが表示

2. グラフ作成
   - データ範囲を選択
   - 「📊 分析」→「グラフを作成」
   - 自動的に棒グラフが挿入

## トラブルシューティング

### メニューが表示されない場合
1. ページの更新
   - F5キーでページを更新
   - または、ブラウザの更新ボタンをクリック

2. スクリプトの確認
   - 「拡張機能」→「Apps Script」で再度エディタを開く
   - コードが正しく保存されているか確認
   - 必要に応じて再度保存

### 権限エラーが表示される場合
1. ブラウザのキャッシュをクリア
2. 再度権限承認を実行
3. 別のGoogleアカウントでログインしている場合は、正しいアカウントに切り替え

### 機能が動作しない場合
1. データの選択範囲を確認
2. 適切なデータ形式か確認（数値、テキストなど）
3. エラーメッセージを確認し、指示に従う

## 注意事項

1. 権限について
   - スクリプトはスプレッドシートの編集権限が必要
   - 初回実行時のみ権限承認が必要
   - 権限は後からいつでも取り消し可能

2. データのバックアップ
   - 重要なデータは事前にバックアップを推奨
   - 特に並べ替えや書式変更を行う前に

3. 共有設定
   - スクリプトを含むスプレッドシートを共有する場合
   - 編集権限を付与する必要あり
   - 閲覧のみの権限ではメニューは使用不可
